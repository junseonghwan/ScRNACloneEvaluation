
## Preparing the data.
+ Call somatic SNVs using Strelka and CNAs using TitanCNA.

## Generating data for comparison to other bulk + single cell methods
+ `GenerateBulkInput.R`:
    * Specify config file in `Laks/Config.txt`.
    * Identifies exonic SNVs from `ov2295_clone_snvs.csv`.
    * Retrieves reads from the bulk data at the identified sites.
    * Retrieves major and minor copy numbers from TitanCNA.
    * Outputs file `ov2295_clone_snvs_exon.cvs`.
+ `ExtractReadCounts.py`:
    * Loads the exonic SNVS from `ov2295_clone_snvs_exon.csv`
    * Launches SLURM jobs to retrieve reads from single cells at the sites.
    * Output the reads for each cell in a txt file.
+ `GenerateScInput.R`:
    * Reads in the exonic SNVs and the single cell reads.
    * It will generate three files: `ssm.txt`, `sc.txt`, and `sc_hp.txt`.
        - `ssm.txt` is a copy of `ov2295_clone_exon.csv`.
        - `sc.txt` contains single cell reads to be inputted to our method.
        - `sc_hp.txt` contains estimate of hyperparameters for quantifying the distribution over the single cell reads.
    * Optionally, it also generates: `ssm_trimmed.txt`, `sc_trimmed.txt`, and `sc_hp_trimmed.txt`.
        - These files are the trimmed version of the above based on MIN_CELLS parameter in `Config.txt`. Any exonic SNV that does not have at least MIN_CELLS with variant reads at the site are discarded.

## Comparison to PhyloWGS

- Requires `py27`.

# Pre-process the data
+ Run `PreparePhyloWGSInput.R`.
+ Run parser in `phylowgs/parser`. Exact commands are found in PhyloWGS website. **TODO: write it here for convenience.**

# Run inference
+ Point to the SNV and CNA files generated by the parser when running inference.

# View the results
```
mkdir cell-line-results
cd cell-line-results
python ../write_results.py cell-line ../trees.zip cell-line.summ.json.gz cell-line.muts.json.gz cell-line.mutass.zip
cd ..
mv cell-line-results witness/data/
cd witness
gunzip data/*/*.gz
python index_data.py
python -m SimpleHTTPServer
```

# How to process the data for our method
+ Run `PrepareInput.R`.
    * This file will generate the data based on what was generated for PhyloWGS.

# Evaluate the results
- To evaluate PhyloWGS results, first, unzip the trees in `witness/data/cell-line`.
- Run `Evaluation.R`.
